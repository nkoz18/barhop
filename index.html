<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Leah's Birthday Bar Hop!</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="anonymous">
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin="anonymous"></script>

  <!-- Icons + Fonts -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Pacifico&display=swap" rel="stylesheet">

  <style>
    :root {
      --rose-600: #e11d48; /* contrasty rose */
      --rose-500: #f43f5e;
      --rose-200: #fecdd3;
      --bg: #fff1f2;       /* soft rose background */
    }
    html, body { height: 100%; }
    body { font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, sans-serif; background: var(--bg); color: #1f2937; }
    .birthday-header { font-family: 'Pacifico', cursive; color: var(--rose-600); }

    /* Map + popups */
    #map { height: 70vh; border-radius: .9rem; border:3px solid var(--rose-200);
           box-shadow: 0 4px 6px -1px rgb(0 0 0 / .1), 0 2px 4px -2px rgb(0 0 0 / .1); }
    .leaflet-container a { color: var(--rose-600); }
    .leaflet-popup-content-wrapper { border-radius:.75rem; border:2px solid var(--rose-600); }
    .leaflet-popup-content {
      margin:.85rem;
      max-width:min(84vw, 360px);
      font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      font-size: .95rem; line-height: 1.45;
    }
    .popup-title { font-weight: 800; font-size: 1.05rem; color:#111827; }
    .popup-section-title { font-weight: 600; color:#111827; margin-top:.25rem; }
    .custom-marker { text-align:center; color: var(--rose-600); font-size: 1.9rem; line-height:1;
                     text-shadow: 0 0 5px rgba(255,255,255,.7);}

    /* On small screens, hide Leaflet popups entirely (we use a separate details card). */
    @media (max-width: 1023px) {
      .leaflet-popup { display: none !important; }
    }

    /* List hover */
    .list-item:hover { background:#ffe4e6; transform: translateX(3px); transition: all .15s ease-in-out; }

    /* Confetti (subtle) */
    .confetti { position: fixed; width:10px; height:10px; opacity:.6; animation: confetti-fall 6s linear infinite;
                border-radius:50%; top:-20px; z-index:0; }
    @keyframes confetti-fall { 0%{transform:translateY(0) rotate(0)} 100%{transform:translateY(110vh) rotate(720deg)} }

    /* Small badge */
    .badge { display:inline-flex; align-items:center; gap:.4rem; padding:.15rem .5rem; border-radius:9999px;
             background:#ffe4e6; color:var(--rose-600); font-weight:600; font-size:.75rem; }
    .popup-links a, .linklike { text-decoration: underline; color: var(--rose-600); }

    /* Hooch critic bits */
    .hooch-row { display:flex; align-items:center; gap:.5rem; margin-top:.35rem; }
    .hooch-stamp { width:28px; height:28px; border-radius:9999px; border:2px solid #fecdd3; box-shadow:0 1px 2px rgba(0,0,0,.08); }
    .hooch-verdict { font-weight:600; color:#e11d48; font-size:.85rem; }

    /* Details card (mobile) */
    #mobile-detail { border:2px solid var(--rose-200); }
  </style>
</head>
<body>
  <!-- Confetti -->
  <div id="confetti-container" aria-hidden="true"></div>

  <!-- Compact top header with circular portrait -->
  <header class="container mx-auto px-4 sm:px-8 pt-6 pb-6 mb-4">
    <div class="flex flex-col sm:flex-row items-center sm:items-end gap-4 sm:gap-6">
      <!-- Circular portrait -->
      <div class="relative w-32 h-32 sm:w-40 sm:h-40 rounded-full ring-4 ring-[var(--rose-200)] shadow-lg overflow-hidden shrink-0">
        <img
          src="./leah.jpg"
          alt="Leah smiling‚Äîbirthday portrait"
          class="absolute inset-0 w-full h-full object-cover"
          loading="eager"
          onerror="this.src='https://picsum.photos/400?blur=3';"
          referrerpolicy="no-referrer"
        />
      </div>

      <div class="text-center sm:text-left">
        <div class="flex items-center justify-center sm:justify-start gap-3">
          <i class="fa-solid fa-cake-candles text-rose-400 text-3xl"></i>
          <h1 class="birthday-header text-4xl sm:text-5xl">Happy Birthday, Leah!</h1>
          <i class="fa-solid fa-cake-candles text-rose-400 text-3xl"></i>
        </div>

        <!-- Intro line (no "Legendary") with pun + dog line -->
        <p class="mt-2 text-gray-800 font-semibold">Operation: Birthday Bar Hop</p>
        <p class="text-gray-700">
          Celebrate our favorite structural engineer with the Ockley Green Renegades‚ÄîNikita, Monica, Mindy &amp; Keith, Linnea &amp; Aaron!
          Why don‚Äôt you take a <strong>Michigander</strong> at our suggestions? We‚Äôll keep it <em>structurally sound</em> and very sippable.
          Our boopable friends (Hooch, Osho, Luna &amp; Appa) expect <strong>pawsitive</strong> updates. üêæ
        </p>

        <p class="mt-2 text-sm text-gray-800 font-semibold bg-rose-100 border border-rose-200 rounded-lg px-2 py-1 inline-flex items-center gap-2">
          <i class="fa-solid fa-car-side"></i>
          Game Plan: Walk when we can; Lyft XL for the long hops (6 people).
          <i class="fa-solid fa-person-walking"></i>
        </p>
      </div>
    </div>

    <!-- Aviation-Adjacent Quest (clarified) -->
    <section class="mt-4 rounded-lg border border-rose-200 bg-white/90 p-3">
      <span class="badge"><i class="fa-solid fa-plane-departure"></i> Aviation-Adjacent Quest</span>
      <p class="mt-2 text-sm text-gray-800">
        Leah‚Äôs favorite cocktail is the <strong>Aviation</strong>‚Äînot to be confused with the Portland gin brand (yes, the Ryan Reynolds one).
        The pre-Prohibition classic mixes <strong>gin, maraschino liqueur, cr√®me de violette</strong> (the purple stuff), and <strong>lemon</strong>.
        Many modern riffs swap in <strong>elderflower</strong> for violette but keep the floral + citrus lift we‚Äôre hunting tonight.
      </p>
    </section>
  </header>

  <!-- MOBILE DETAILS CARD (shown on phones above the map; hidden on desktop) -->
  <section id="mobile-detail" class="container mx-auto px-4 sm:px-8 mb-3 hidden lg:hidden rounded-xl bg-white/95 p-4">
    <!-- Filled dynamically when a marker/list item is tapped on mobile -->
    <div class="text-sm text-gray-600">Tap a pin or a spot below to see details here.</div>
  </section>

  <!-- CONTENT -->
  <main class="container mx-auto px-4 sm:px-8 pt-2 pb-6 relative z-10">
    <!-- Map first, list below on mobile; side-by-side on desktop -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <div class="lg:col-span-2 order-1">
        <div id="map" aria-label="Map of bar hop locations"></div>
        <p class="mt-2 text-xs text-gray-600">Tip: tap a marker or pick a spot from the list.</p>
      </div>

      <!-- Desktop sidebar (list) -->
      <aside class="order-2 hidden lg:block">
        <div class="bg-white/90 backdrop-blur-sm p-4 rounded-xl shadow-lg border border-rose-200 max-h-[70vh] overflow-y-auto">
          <h2 class="text-2xl font-extrabold mb-3 border-b-2 border-rose-200 pb-2 text-[var(--rose-600)]">The Hot Spots</h2>
          <ul id="bar-list-desktop" class="space-y-2"></ul>
          <div class="mt-4 text-xs text-gray-600">
            <span class="badge"><i class="fa-solid fa-plane-departure"></i> Aviation-adjacent</span>
            picks are flagged where applicable.
          </div>
        </div>
      </aside>
    </div>

    <!-- Mobile list (full list below the map) -->
    <section class="mt-6 lg:hidden">
      <h2 class="text-xl font-extrabold mb-2 text-[var(--rose-600)]">The Hot Spots</h2>
      <ul id="bar-list-mobile" class="space-y-2"></ul>
      <div class="mt-3 text-xs text-gray-600">
        <span class="badge"><i class="fa-solid fa-plane-departure"></i> Aviation-adjacent</span>
        picks are flagged where applicable.
      </div>
    </section>
  </main>

  <script>
    // ---- Confetti (subtle) ----
    (function () {
      const c = document.getElementById('confetti-container');
      const colors = ['#f43f5e', '#fecdd3', '#fde68a', '#a78bfa'];
      for (let i = 0; i < 50; i++) {
        const dot = document.createElement('div');
        dot.className = 'confetti';
        dot.style.left = `${Math.random() * 100}vw`;
        dot.style.animationDelay = `${Math.random() * 5}s`;
        dot.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
        dot.style.transform = `scale(${Math.random() * 0.55 + 0.55})`;
        c.appendChild(dot);
      }
    })();

    // ---- Helpers ----
    const mq = window.matchMedia('(max-width: 1023px)');
    let isMobile = mq.matches;
    mq.addEventListener?.('change', e => { isMobile = e.matches; });

    const toMaps       = (name) => `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(name + ' Portland OR')}`;
    const toMenuSearch = (name) => `https://www.google.com/search?q=${encodeURIComponent(name + ' Portland menu')}`;
    const toInstaSearch= (name) => `https://www.google.com/search?q=${encodeURIComponent(name + ' Instagram Portland')}`;

    // Paws display: show ONLY filled paws (no empty placeholders).
    const paws = (n=0) => 'üêæ'.repeat(Math.max(0, Math.min(5, n)));

    // ---- Data (your jokes intact) + optional Hooch reviews ----
    const bars = [
      { name: "Angel Face",
        vibe: "A fancy spot for our fancy engineer! The perfect place for an 'old lady' like Leah to enjoy a sophisticated, bespoke cocktail that's as structurally sound as her designs.",
          highlights: "<b>Bespoke Cocktails:</b> The main event! <br><b> (NA):</b> Describe your favorite flavors and they'll craft a non-alcoholic masterpiece. <br> <b>Food:</b> Oysters & Steak Frites.",
        aviationAdj: true,
        hoochReview: { rating: 4, verdict: "Big Tail Wags", blurb: "Floral lane on request; cozy den energy." }
      },
      { name: "Bible Club",
        vibe: "A secret spot for the renegades who know a thing or two about finding a way into the old Ockley Green dog park. A great place for Mindy and Leah to toast to Hooch and Osho's friendship.",
        highlights: "<b>The Biblical Garden:</b> A floral, bubbly gin drink. <br> <b> (NA):</b> Their 'Temperance' section features complex NA cocktails like the 'Phony Negroni'.",
        aviationAdj: true,
        hoochReview: { rating: 4, verdict: "Big Tail Wags", blurb: "Speakeasy smells pass the snoot test." }
      },
      { name: "Deadshot",
        vibe: "Let's see if Mindy and Keith's expert palates from roasting coffee translate to these wild cocktails! A perfect spot for the adventurous members of the dog park crew.",
        highlights: "<b>Who Is Jack Nance?:</b> A unique whiskey sour. <br> <b> (NA):</b> Ask for a 'Temperance' drink; they're known for creative NA options.",
        aviationAdj: false
      },
      { name: "Driftwood Room",
        vibe: "A classic, dark spot where sports-lover Aaron can probably find a TV, but will be forced to socialize instead. Perfect for the ski crew to plan their next mountain conquest.",
        highlights: "<b>Springtime in Paris:</b> Elderflower, grapefruit, bubbles. <br> <b> (NA):</b> They make a great 'French 75-ish' with sparkling cider.",
        aviationAdj: true,
        hoochReview: { rating: 5, verdict: "Full-Body Zoomies", blurb: "Bubbly + floral = instant woo-woo." }
      },
      { name: "Expatriate",
        vibe: "This place is as effortlessly cool as an all-white Husky in a snowstorm. Perfect vibes for celebrating Leah with legendary nachos to give everyone party-fuel.",
        highlights: "<b>Night Dreamer:</b> Cognac, elderflower, citrus. <br> (NA):</b> Try their house-made shrubs and sodas. <br> <b>Food:</b> Expatriate Nachos are a must.",
        aviationAdj: true,
        hoochReview: { rating: 5, verdict: "Full-Body Zoomies", blurb: "Elderflower lift; chonk-worthy nachos." }
      },
      { name: "Function NE",
        vibe: "For connoisseurs, like a dog appreciating a truly fine squeaky toy. While beer-focused, it's a great stop for the crew to try something new and noteworthy.",
        highlights: "<b>Rotating Tap List:</b> Always something new. <br> <b> (NA):</b> Usually has interesting ciders, kombuchas, or specialty sodas on tap.",
        aviationAdj: false
      },
      { name: "Hey Love",
        vibe: "It's a tropical party in here, much like the inside of Leah's mind when she thinks about Hooch. A perfect spot for Nikita to treat the birthday girl to a fun drink!",
        highlights: "<b>Master of Karate & Friendship:</b> A fros√© with rum. <br> <b> (NA):</b> Extensive NA menu, including the 'Passionfruit No-Groni'.",
        aviationAdj: false
      },
      { name: "Moloko",
        vibe: "The dark, moody vibe here is perfect for Luna to blend right in... and for Linnea our teacher to finally decompress after a long week. She's definitely earned this!",
        highlights: "<b>Company Party:</b> Lavender-infused gin, lemon, bubbles. <br> <b> (NA):</b> They offer a variety of intriguing NA cocktails on their menu.",
        aviationAdj: true,
        hoochReview: { rating: 4, verdict: "Big Tail Wags", blurb: "Lavender nose; dignified floof zone." }
      },
      { name: "Roadside Attraction",
        vibe: "This place is so weird and wonderful, even Monica's dog Appa would be impressed. It has as much chaotic history as the Ockley Green dog park before the 'incidents'.",
        highlights: "<b>Cozy Fire Pits:</b> Great for a group hang. <br> <b> (NA):</b> Classic sodas and juices in a one-of-a-kind setting.",
        aviationAdj: false
      },
      { name: "Slammer Tavern",
        vibe: "The official after-party spot where Aaron can try ordering a round in every language he knows. No-frills, all fun, where Nikita can buy more rounds with the money saved.",
        highlights: "<b>Strong, Affordable Drinks:</b> The main event. <br> <b> (NA):</b> A solid spot for a classic soda or juice.",
        aviationAdj: false
      }
    ];

    const barCoords = {
      "Angel Face":[45.5244,-122.6395],"Bible Club":[45.4741,-122.6496],"Deadshot":[45.5085,-122.6548],
      "Driftwood Room":[45.5199,-122.6872],"Expatriate":[45.5619,-122.6358],"Function NE":[45.5592,-122.6450],
      "Hey Love":[45.5229,-122.6565],"Moloko":[45.5518,-122.6766],"Roadside Attraction":[45.5152,-122.6540],
      "Slammer Tavern":[45.5186,-122.6575]
    };

    // ---- Map ----
    const map = L.map('map', { zoomControl: true }).setView([45.53, -122.65], 12.4);
    L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
      attribution: '&copy; OpenStreetMap &copy; CARTO', maxZoom: 20
    }).addTo(map);

    // UI targets
    const listDesktop = document.getElementById('bar-list-desktop');
    const listMobile  = document.getElementById('bar-list-mobile');
    const detailCard  = document.getElementById('mobile-detail');

    // Marker icon
    const cocktailIcon = L.divIcon({
      html: '<i class="fa-solid fa-martini-glass-citrus custom-marker"></i>',
      className: '', iconSize: [24,24], iconAnchor: [12,24], popupAnchor: [0,-24]
    });

    const group = L.featureGroup();

    // Build link row
    const makeLinks = (name) => `
      <div class="flex flex-wrap items-center gap-3 mt-2 text-sm">
        <a class="linklike" target="_blank" rel="noopener" href="${toMenuSearch(name)}">Menu</a>
        <span class="text-gray-400" aria-hidden="true">¬∑</span>
        <a class="linklike" target="_blank" rel="noopener" href="${toInstaSearch(name)}">Instagram</a>
        <span class="text-gray-400" aria-hidden="true">¬∑</span>
        <a class="linklike" target="_blank" rel="noopener" href="${toMaps(name)}">Google Maps</a>
      </div>`;

    // Mobile detail renderer
    function renderMobileDetail(bar) {
      if (!bar) { detailCard.classList.add('hidden'); return; }
      detailCard.classList.remove('hidden');
      const hooch = bar.hoochReview ? `
        <div class="hooch-row" aria-label="Hooch‚Äôs Haute-Takes">
          <img src="./hooch_critic.png" alt="Hooch the Husky ‚Äî house critic" class="hooch-stamp" width="28" height="28">
          <div>
            <div class="hooch-verdict">${bar.hoochReview.verdict} <span aria-label="${bar.hoochReview.rating} out of 5 paws">${paws(bar.hoochReview.rating)}</span></div>
            ${bar.hoochReview.blurb ? `<div class="text-[.85rem] text-gray-700">${bar.hoochReview.blurb}</div>` : ``}
          </div>
        </div>` : ``;

      detailCard.innerHTML = `
        <div class="flex items-start gap-2">
          <h3 class="text-lg font-extrabold text-gray-900">${bar.name}</h3>
          ${bar.aviationAdj ? '<span class="badge"><i class="fa-solid fa-plane-departure"></i> Aviation-adjacent</span>' : ''}
        </div>
        ${hooch}
        <p class="mt-1 text-gray-700">"${bar.vibe}"</p>
        <div class="mt-2 text-gray-800">
          <div class="font-semibold">Highlights:</div>
          <p>${bar.highlights}</p>
        </div>
        ${makeLinks(bar.name)}
      `;
      // Scroll the card into view for small screens
      detailCard.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    // Sidebar / list item factory
    function makeListItem(bar, coords) {
      const li = document.createElement('li');
      li.className = 'p-2 rounded-lg cursor-pointer list-item';
      li.innerHTML = `
        <div class="flex items-center justify-between">
          <span class="font-semibold">${bar.name}</span>
          ${bar.aviationAdj ? '<span class="badge"><i class="fa-solid fa-plane-departure"></i> Adj.</span>' : ''}
        </div>
        ${bar.hoochReview ? `<div class="mt-1 text-xs text-rose-600 font-semibold">${bar.hoochReview.verdict} ${paws(bar.hoochReview.rating)}</div>` : ``}
        <div class="mt-1 text-xs text-gray-700">${bar.vibe}</div>
        <div class="mt-1 text-xs text-gray-700"><span class="font-semibold">Highlights:</span> ${bar.highlights}</div>
        <div class="mt-1 text-xs flex flex-wrap gap-2">
          <a class="underline text-[var(--rose-600)]" target="_blank" rel="noopener" href="${toMenuSearch(bar.name)}">Menu</a>
          <span class="text-gray-400">¬∑</span>
          <a class="underline text-[var(--rose-600)]" target="_blank" rel="noopener" href="${toInstaSearch(bar.name)}">Instagram</a>
          <span class="text-gray-400">¬∑</span>
          <a class="underline text-[var(--rose-600)]" target="_blank" rel="noopener" href="${toMaps(bar.name)}">Maps</a>
        </div>
      `;
      li.setAttribute('role', 'button');
      li.setAttribute('tabindex', '0');
      li.addEventListener('click', () => {
        map.flyTo(coords, 15, { duration: .6 });
        if (isMobile) {
          renderMobileDetail(bar);
        } else {
          // On desktop, open popup on the associated marker
          const m = markerByName.get(bar.name);
          if (m) m.openPopup();
        }
      });
      li.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); li.click(); }
      });
      return li;
    }

    // Build markers + lists
    const markerByName = new Map();

    bars.forEach(bar => {
      const coords = barCoords[bar.name];
      const marker = L.marker(coords, { icon: cocktailIcon }).addTo(map);
      markerByName.set(bar.name, marker);

      // Desktop popup content
      const popup = `
        <div>
          <div class="flex items-center gap-2">
            <h3 class="popup-title">${bar.name}</h3>
            ${bar.aviationAdj ? '<span class="badge"><i class="fa-solid fa-plane-departure"></i> Aviation-adjacent</span>' : ''}
          </div>
          ${bar.hoochReview ? `
            <div class="hooch-row" aria-label="Hooch‚Äôs Haute-Takes">
              <img src="./hooch_critic.png" alt="Hooch the Husky ‚Äî house critic" class="hooch-stamp" width="28" height="28">
              <div>
                <div class="hooch-verdict">${bar.hoochReview.verdict} <span aria-label="${bar.hoochReview.rating} out of 5 paws">${paws(bar.hoochReview.rating)}</span></div>
                ${bar.hoochReview.blurb ? `<div class="text-[.8rem] text-gray-700">${bar.hoochReview.blurb}</div>` : ``}
              </div>
            </div>` : ``}
          <p class="mt-1 text-gray-700">"${bar.vibe}"</p>
          <div class="mt-2 text-gray-800">
            <div class="popup-section-title">Highlights:</div>
            <p>${bar.highlights}</p>
          </div>
          ${makeLinks(bar.name)}
        </div>`;

      marker.bindPopup(popup, { closeButton: true });
      group.addLayer(marker);

      // Marker click behavior depends on viewport
      marker.on('click', () => {
        if (isMobile) {
          renderMobileDetail(bar);
        } else {
          marker.openPopup();
        }
      });

      // Lists (desktop & mobile)
      const liDesk = makeListItem(bar, coords);
      const liMob  = makeListItem(bar, coords);
      listDesktop.appendChild(liDesk);
      listMobile.appendChild(liMob);
    });

    // Fit map to markers on load (good for mobile)
    map.whenReady(() => {
      if (group.getLayers().length) {
        map.fitBounds(group.getBounds().pad(0.12), { animate: false });
      }
    });
  </script>
</body>
</html>
